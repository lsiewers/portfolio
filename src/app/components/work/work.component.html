<article class="work container" *ngIf="items">
  <header class="work__header">
    <h1
      class="work__header__title title centered grey"
      title="Work"
      *ngIf="pageType === 'home'"
    >Work</h1>

    <!-- filters -->
    <ul class="work__header__filters" *ngIf="pageType === 'home'">
      <li
        class="work__header__filters__filter"
        *ngFor="let filter of filterClass.filters"
        [class.tab--open]="filter.openTab"
        [class.tab--closed]="!filter.openTab"
      >
        <span
          class="work__header__filters__filter__label button button--dark"
          (clickOutside)="filter.openTab ? filterClass.toggleFilterTab(filter) : null"
          [exclude]="'.work__header__filters__filter__dropdown'"
          (click)="filterClass.toggleFilterTab(filter)"
        >{{filter.type}}</span>
        <!-- arrow icon -->
        <ul class="work__header__filters__filter__dropdown">

          <!-- uncategorized items -->
          <ng-container *ngIf="!valuesCategorized(filter.values)">
            <div class="work__header__filters__filter__dropdown__categorie">
              <li
                class="work__header__filters__filter__dropdown__value"
                *ngFor="let value of filter.values"
                (click)="filterClass.toggleFilter({type: filter.type, values: [value]})"
                [class.filter--active]="filterClass.findActiveFilter(filter.type, value)"
              >
                {{value}}
              </li>
            </div>
          </ng-container>

          <!-- categorized items -->
          <ng-container *ngIf="valuesCategorized(filter.values)">
            <li *ngFor="let categorie of filter.values">
              <ul class="work__header__filters__filter__dropdown__categorie">
                  <h3>{{categorie.name}}</h3>
                  <li
                    *ngFor="let value of categorie.values;"
                    class="work__header__filters__filter__dropdown__value"
                    [class.filter--active]="filterClass.findActiveFilter(filter.type, value)"
                    (click)="filterClass.toggleFilter({type: filter.type, values: [filter.value]})"
                  >
                    {{value}}
                  </li>
              </ul>
            </li>
          </ng-container>
        </ul>
      </li>
    </ul>
    <!-- end filters -->

    <p
      class="work__header__filters__text"
      [class.no-filters]="filterClass.activeFilters.length <= 0"
      *ngIf="pageType === 'home'"
    >
      {{filterClass.activeFilters.length > 0 ? '' : 'No filter applied'}}
      <ng-container *ngFor="let filter of filterClass.activeFilters">
        <div
          class="button"
          *ngFor="let value of filter.values"
          (click)="filterClass.toggleFilter({type: filter.type, values: [filter.value]})"
        >{{value}}</div>
      </ng-container>
    </p>
    <p
      class="work__header__filters__text"
      *ngIf="pageType === 'work' && filterClass.projectFocus">
      More focused on {{ filterClass.projectFocus.values }}
    </p>

  </header>

  <main class="work__items">
    <!-- <p class="work__items__results">{{showItems.length ? showItems.length : 'No'}} {{showItems.length <= 1 ? 'result' : 'results'}}</p> -->
    <ul
      class="work__items__list"
      #container
      [ngClass]="{'is--loading': !masonryLoaded, 'is--loaded': masonryLoaded}"
    >
      <li
        class="work__items__list__item"
        *ngFor="let item of showItems"
        (click)="routeToPost(item.title); hoverLeave($event)"
        (mousemove)="hoverAnimation($event)"
        (mouseleave)="hoverLeave($event)"
      >
        <article>
          <figure>
              <img
                [src]="item.media.imageUrl"
                [alt]="item.title"
                (load)="imageLoaded();"
                *ngIf="item.media.imageUrl"
              >
              <!-- <video nocontrols [hidden]="!item.media.videoPlaying">
                <source src="{{item.media.videoUrl}}">
              </video> -->
          </figure>
          <div>
            <ul *ngIf="item.metadata">
              <li>{{getMetadataValue(item.metadata, 'focus')}}</li>
              <li>{{getMetadataValue(item.metadata, 'purpose')}}</li>
            </ul>
            <h1 class="title grey" title="{{item.title}}">{{item.title}}</h1>
            <p class="title grey" title="{{item.subtitle}}">{{item.subtitle}}</p>
          </div>
        </article>
      </li>
    </ul>
    <a
      class="work__items__show-button button button--light"
      *ngIf="items.length > showAmount"
      (click)="showAmount = showAmount + 3; showItems = filterClass.getFilteredItems()"
    >
      Show More
    </a>
  </main>
</article>
